"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[2239],{28453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>a});var n=s(96540);const i={},r=n.createContext(i);function o(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(r.Provider,{value:t},e.children)}},56048:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>c,frontMatter:()=>o,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"Engineering/DevOps/AutomationCodeDocs/GitHubActions/ReleaseIssues","title":"Release Issues","description":"The automated release process works well a vast majority of the time but occasionally there are issues that may require some manual intervention. These issues can be caused by either upstream issues with the app stores or due to issues with our build. This page is meant to document some of the issues we may run into with our releases and how to resolve them.","source":"@site/docs/Engineering/DevOps/AutomationCodeDocs/GitHubActions/ReleaseIssues.md","sourceDirName":"Engineering/DevOps/AutomationCodeDocs/GitHubActions","slug":"/Engineering/DevOps/AutomationCodeDocs/GitHubActions/ReleaseIssues","permalink":"/va-mobile-app/docs/Engineering/DevOps/AutomationCodeDocs/GitHubActions/ReleaseIssues","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Other Workflows","permalink":"/va-mobile-app/docs/Engineering/DevOps/AutomationCodeDocs/GitHubActions/OtherWorkflows"},"next":{"title":"Scripts, Etc.","permalink":"/va-mobile-app/docs/Engineering/DevOps/AutomationCodeDocs/Scripts"}}');var i=s(74848),r=s(28453);const o={},a="Release Issues",l={},h=[{value:"Re-releasing a failed build",id:"re-releasing-a-failed-build",level:2},{value:"App Store screenshot failure",id:"app-store-screenshot-failure",level:2},{value:"Need to add code into a release after it has been created (but not pushed to the stores)",id:"need-to-add-code-into-a-release-after-it-has-been-created-but-not-pushed-to-the-stores",level:2},{value:"Release Ticket Failure",id:"release-ticket-failure",level:2}];function d(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"release-issues",children:"Release Issues"})}),"\n",(0,i.jsx)(t.p,{children:"The automated release process works well a vast majority of the time but occasionally there are issues that may require some manual intervention. These issues can be caused by either upstream issues with the app stores or due to issues with our build. This page is meant to document some of the issues we may run into with our releases and how to resolve them."}),"\n",(0,i.jsx)(t.h2,{id:"re-releasing-a-failed-build",children:"Re-releasing a failed build"}),"\n",(0,i.jsxs)(t.p,{children:["Occasionally, a build may fail for one reason or another, or we may determine that we want to resubmit a build. In order to do this, we need to re-trigger the ",(0,i.jsx)(t.a,{href:"https://department-of-veterans-affairs.github.io/va-mobile-app/docs/Engineering/DevOps/Automation%20Code%20Docs/GitHub%20Actions/BuildReleaseWorkflows#release-build-release_build",children:"Release Build"})," workflow. This workflow is triggered by tagging the release branch with a ",(0,i.jsx)(t.code,{children:"vX.X.X"})," tag. Since this tag exists already, follow the steps below to re-tag a branch and retrigger the build. Keep in mind that the releases for both platforms are tied together in the same workflow, so following these steps will re-run the release for both iOS and Android."]}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"Determine the version number of the build you want to rebuild (vX.X.X)"}),"\n",(0,i.jsxs)(t.li,{children:["If possible, remove any pending versions for review","\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://appstoreconnect.apple.com/apps/1559609596/distribution",children:"App Store Connect"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://play.google.com/console/u/0/developers/7507611851470273082/app/4974294731909201030/releases/overview",children:"Google Play Console"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["Make any changes necessary to the corresponding ",(0,i.jsx)(t.code,{children:"release/vX.X.X"})," branch or have an FE engineer do so"]}),"\n",(0,i.jsxs)(t.li,{children:["Since the ",(0,i.jsx)(t.code,{children:"vX.X.X"})," tag exists already from the previous build attempt, we need to delete the tag, both locally and remotely","\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["Delete the local tag: ",(0,i.jsx)(t.code,{children:"git tag --delete <vX.X.X>"})]}),"\n",(0,i.jsxs)(t.li,{children:["Delete the remote tag: ",(0,i.jsx)(t.code,{children:"git push --delete origin <vX.X.X>"})]}),"\n",(0,i.jsxs)(t.li,{children:["Checkout the ",(0,i.jsx)(t.code,{children:"release/vX.X.X"})," branch"]}),"\n",(0,i.jsxs)(t.li,{children:["Run ",(0,i.jsx)(t.code,{children:"git pull"})," to ensure you have the latest changes"]}),"\n",(0,i.jsxs)(t.li,{children:["Tag the branch with the version we're trying to release: ",(0,i.jsx)(t.code,{children:"git tag -a vX.X.X -m vX.X.X"})]}),"\n",(0,i.jsxs)(t.li,{children:["Push the tag ",(0,i.jsx)(t.code,{children:"git push origin vX.X.X"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["Confirm that the ",(0,i.jsx)(t.a,{href:"https://github.com/department-of-veterans-affairs/va-mobile-app/actions/workflows/release_build.yml",children:"Release Build"})," has been retriggered"]}),"\n",(0,i.jsx)(t.li,{children:"Upon successful build, check the corresponding App Store console to confirm that the build is present and has been submitted for review"}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"app-store-screenshot-failure",children:"App Store screenshot failure"}),"\n",(0,i.jsxs)(t.p,{children:["Occasionally the uploading of screenshots to the iOS App Store will fail due to timeout. A recent fastlane version update included some optimizations to fix this but it's possible it can occur again. Screenshots are uploaded ",(0,i.jsx)(t.em,{children:"after"})," a successful build has already been uploaded to App Store Connect. Sometimes we can fix the screenshots manually in App Store connect. To do so:"]}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["Go to the pending release in ",(0,i.jsx)(t.a,{href:"https://appstoreconnect.apple.com/apps/1559609596/distribution",children:"App Store Connect"})]}),"\n",(0,i.jsx)(t.li,{children:'On the Distribution tab, you should see the "iOS Previews and Screenshots" section'}),"\n",(0,i.jsxs)(t.li,{children:["For each screen size and device:","\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"Remove any failed screenshots. They usually appear as blank with no image preview"}),"\n",(0,i.jsxs)(t.li,{children:["Check if there is a button in the top right that allows you to re-submit the app for review.","\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:'If not, you will likely need to re-release the entire build by following the steps for "Re-releasing a failed build" instead'}),"\n",(0,i.jsx)(t.li,{children:"If so, continue with the next steps"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["Comparing it to the screenshots in the ",(0,i.jsx)(t.code,{children:"release/vX.X.X"})," branch, check the order and upload any missing screenshots"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.li,{children:"Re-submit the app for review"}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"need-to-add-code-into-a-release-after-it-has-been-created-but-not-pushed-to-the-stores",children:"Need to add code into a release after it has been created (but not pushed to the stores)"}),"\n",(0,i.jsx)(t.p,{children:"Sometimes, after a release branch has been cut, we need to get an important update included before approval. When this happens, we need to recreate the release candidate build. If QA hasn't happened yet, there's no extra effort, but if QA has completed testing on the release candidate, it will need to be retested. Updating the the release needs to be approved by the QA team."}),"\n",(0,i.jsx)(t.p,{children:'Because the release is tied into a commit and not the current state of the branch, follow the steps below to "re-cut" the release:'}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["Add updated code into the release branch ",(0,i.jsx)(t.code,{children:"release/vX.X.X"})," and push to github"]}),"\n",(0,i.jsxs)(t.li,{children:["Delete the local release candidate tag: ",(0,i.jsx)(t.code,{children:"git tag --delete RC-vX.XX.0-XXXXXX-XXXX"})]}),"\n",(0,i.jsxs)(t.li,{children:["Delete the remote tag: ",(0,i.jsx)(t.code,{children:"git push --delete origin <RC-vX.XX.0-XXXXXX-XXXX>"})]}),"\n",(0,i.jsxs)(t.li,{children:["Checkout the ",(0,i.jsx)(t.code,{children:"release/vX.X.X"})," branch"]}),"\n",(0,i.jsxs)(t.li,{children:["Run ",(0,i.jsx)(t.code,{children:"git pull"})," to ensure you have the latest changes"]}),"\n",(0,i.jsxs)(t.li,{children:["Tag the branch with the version we're trying to release: ",(0,i.jsx)(t.code,{children:"git tag -a RC-vX.XX.0-XXXXXX-XXXX -m RC-vX.XX.0-XXXXXX-XXXX"})]}),"\n",(0,i.jsxs)(t.li,{children:["Push the tag ",(0,i.jsx)(t.code,{children:"git push origin RC-vX.XX.0-XXXXXX-XXXX"})]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"release-ticket-failure",children:"Release Ticket Failure"}),"\n",(0,i.jsx)(t.p,{children:"Outlined below are the steps to follow when the automation to create a release ticket and Slack coordination thread fails due to issues like incorrect GitHub username assignment."}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["Update the ",(0,i.jsx)(t.a,{href:"https://github.com/department-of-veterans-affairs/va-mobile-app/blob/develop/.github/ISSUE_TEMPLATE/release_ticket.md",children:"release_ticket"})," template with the correct GitHub username and push to Github"]}),"\n",(0,i.jsx)(t.li,{children:"Determine the version number of the build (vX.X.X) and RC tag RC-vX.XX.0-XXXXXX-XXXX you want to delete"}),"\n",(0,i.jsxs)(t.li,{children:["Delete the local release candidate tag: ",(0,i.jsx)(t.code,{children:"git tag --delete RC-vX.XX.0-XXXXXX-XXXX"})]}),"\n",(0,i.jsxs)(t.li,{children:["Delete the remote tag: ",(0,i.jsx)(t.code,{children:"git push --delete origin <RC-vX.XX.0-XXXXXX-XXXX>"})]}),"\n",(0,i.jsxs)(t.li,{children:["Delete the local release branch : ",(0,i.jsx)(t.code,{children:"git branch -d <release/vX.X.X>"})]}),"\n",(0,i.jsxs)(t.li,{children:["Delete the remote release branch: ",(0,i.jsx)(t.code,{children:"git push origin --delete <release/vX.X.X>"})]}),"\n",(0,i.jsxs)(t.li,{children:["Manually ran the ",(0,i.jsx)(t.a,{href:"https://github.com/department-of-veterans-affairs/va-mobile-app/actions/workflows/new_release_branch.yml",children:"new_release_branch"})," workflow using workflow_dispatch targeting the ",(0,i.jsx)(t.code,{children:"develop"})," branch."]}),"\n",(0,i.jsxs)(t.li,{children:["Confirm that:","\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"New RC tag."}),"\n",(0,i.jsx)(t.li,{children:"New release branch."}),"\n",(0,i.jsx)(t.li,{children:"release ticket has been created."}),"\n",(0,i.jsx)(t.li,{children:"Slack thread coordination has been triggered on va-mobile-app channel."}),"\n"]}),"\n"]}),"\n"]})]})}function c(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);