"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[9466],{18147:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/firebase-perf-facbe5722d7821f3060be7afd864c565.png"},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>o});var i=n(96540);const s={},a=i.createContext(s);function r(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(a.Provider,{value:t},e.children)}},30437:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/firebase-events-de4c3f2da1d42c7150d0160ea8a27c65.png"},50547:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/firebase-nav-overview-2b1e88900d1de754299c46db28998f94.png"},55901:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/firebase-realtime-cf198b922fe8a13c3bc49bbb9e590ffa.png"},60791:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/firebase-analytics-query-531633e133023315ee9254e89560dbd6.png"},69387:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/firebase-crashlytics-cf300187189f2578dda994fc72274305.png"},75291:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"Operations/App metrics/Firebase","title":"Firebase","description":"Overview","source":"@site/docs/Operations/App metrics/Firebase.md","sourceDirName":"Operations/App metrics","slug":"/Operations/App metrics/Firebase","permalink":"/va-mobile-app/docs/Operations/App metrics/Firebase","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Firebase","sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Updating the dashboard","permalink":"/va-mobile-app/docs/Operations/App metrics/UpdatingDashboard"},"next":{"title":"Releases","permalink":"/va-mobile-app/docs/Operations/Releases/"}}');var s=n(74848),a=n(28453);const r={title:"Firebase",sidebar_position:3},o=void 0,l={},d=[{value:"Overview",id:"overview",level:2},{value:"Crashlytics",id:"crashlytics",level:2},{value:"Performance",id:"performance",level:2},{value:"App Distribution",id:"app-distribution",level:2},{value:"Analytics",id:"analytics",level:2},{value:"To Add a New Analytics Event",id:"to-add-a-new-analytics-event",level:3},{value:"Naming Requirements",id:"naming-requirements",level:3},{value:"Dashboard",id:"dashboard",level:3},{value:"Realtime",id:"realtime",level:3},{value:"Events",id:"events",level:3},{value:"DebugView",id:"debugview",level:3}];function c(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(t.p,{children:["Firebase is a Google Cloud system which can capture analytics, performance, and crash data from our deployed app.\nThe ",(0,s.jsx)(t.a,{href:"https://console.firebase.google.com/u/0/project/va-mobile-app/",children:"Firebase Console"})," offers an overview into the app"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"If you are unable to access the console, request access from the team or project lead"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Further information available in each of the subcategories in the navigation menu"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Navigation Overview",src:n(50547).A+"",width:"257",height:"718"})}),"\n",(0,s.jsx)(t.p,{children:"The important sections within the console are listed below. Anything not listed is likely not used or not intergrated into the app at this time"}),"\n",(0,s.jsx)(t.p,{children:"Something to note about all the data presented in these sections, none of the data is attributed to individual users for purposes of anonymity and privacy. The tools here allow you to get data on events and see stack traces of crashes, but not directly debug the issues of a specific user."}),"\n",(0,s.jsxs)(t.p,{children:["All analytics, crashlytics, and performance are turned off for non-production environments, with the only exception being ",(0,s.jsx)(t.a,{href:"#debugview",children:"DebugView"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"crashlytics",children:"Crashlytics"}),"\n",(0,s.jsxs)(t.p,{children:["Crashlytics provides metrics on app crashes that occur in production, and can be filtered by release and platform. You'll find the platform dropdown at the top of the page next to the ",(0,s.jsx)(t.strong,{children:"Crashlytics"})," title. The filter at the top left under the title allows you to select which release number to look at and the filter at the top right allows you to choose a different date range."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Crashlytics Dashboard",src:n(69387).A+"",width:"1274",height:"926"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"https://firebase.google.com/docs/crashlytics",children:"Crashlytics"})," is added to the app through the ",(0,s.jsx)(t.code,{children:"@react-native-firebase/crashlytics"})," package. The only code added to the repo which affects Crashlytics is for toggling ",(0,s.jsx)(t.a,{href:"#debugview",children:"DebugView"})," and explained in that section."]}),"\n",(0,s.jsx)(t.h2,{id:"performance",children:"Performance"}),"\n",(0,s.jsxs)(t.p,{children:["Performance provides many default metrics on http requests and app runtime, and can be filtered by platform. You'll find the platform dropdown at the top of the page next to the ",(0,s.jsx)(t.strong,{children:"Crashlytics"})," title. The filter at the top right allows you to choose a different date range."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Performance Dashboard",src:n(18147).A+"",width:"1262",height:"1052"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"https://firebase.google.com/docs/perf-mon",children:"Performance"})," is added to the app through the ",(0,s.jsx)(t.code,{children:"@react-native-firebase/perf"})," package. The only code added to the repo which affects Performance is for toggling ",(0,s.jsx)(t.a,{href:"#debugview",children:"DebugView"})," and explained in that section. Additional custom traces can be added to the code by following the examples in the package docs."]}),"\n",(0,s.jsx)(t.h2,{id:"app-distribution",children:"App Distribution"}),"\n",(0,s.jsxs)(t.p,{children:["App Distribution provides a dashboard for all the releases of the app. It lists previous releases, allows for creating a new release, provides invite links and group permissions for testers and other groups. Each release contains notes for its purpose, whether it is a QA build or one for UAT or a proper release build. Only people with permissions to use the distribution tools will be able to build new releases. The contact info for the person with top level permission will be listed on that page under ",(0,s.jsx)(t.code,{children:"Contant Email"})]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"App Distribution Dashboard",src:n(90541).A+"",width:"1255",height:"855"})}),"\n",(0,s.jsx)(t.h2,{id:"analytics",children:"Analytics"}),"\n",(0,s.jsx)(t.p,{children:"Analytics provides metrics on discrete events within the app. Most general events like accessing a screen are built into the package and provided in the dashboard without any additional coding, but all other actions like pressing a button or downloading a file are tracked as a custom analytic event. These events are collated and displayed in multiple ways in the Analytics subsections of the nav menu, as listed in the subsections below."}),"\n",(0,s.jsx)(t.h3,{id:"to-add-a-new-analytics-event",children:"To Add a New Analytics Event"}),"\n",(0,s.jsxs)(t.p,{children:["Add an event name with optional parameters to the ",(0,s.jsx)(t.code,{children:"Events"})," constant in ",(0,s.jsx)(t.code,{children:"constants/analytics.ts"}),"."]}),"\n",(0,s.jsx)(t.h3,{id:"naming-requirements",children:"Naming Requirements"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Snake_case",children:"Snake case"})}),"\n",(0,s.jsxs)(t.li,{children:["Prefixed with ",(0,s.jsx)(t.code,{children:"vama_"})]}),"\n",(0,s.jsxs)(t.li,{children:["Limited to 24 characters including the ",(0,s.jsx)(t.code,{children:"vama_"})," prefix"]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["See examples below or in our ",(0,s.jsx)(t.a,{href:"https://github.com/department-of-veterans-affairs/va-mobile-app/blob/dbce4aeaac76b2a49d56b9fc46f4be5cd15bce23/VAMobile/src/constants/analytics.ts",children:"analytics constants file"})]}),"\n",(0,s.jsxs)(t.p,{children:["Additionally, if user properties need to be tracked, they can be added to the ",(0,s.jsx)(t.code,{children:"UserAnalytics"})," object:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"export const Events = {\n  ... ,\n  vama_new_event_name: (): Event => {\n    return {\n      name: 'vama_new_event_name',\n      params: {\n        paramName,\n      },\n    }\n  },\n}\n\nexport const UserAnalytics = {\n  ... ,\n  vama_uses_property: (value: boolean): UserAnalytic => {\n    return {\n      name: 'vama_uses_property',\n      value: value.toString(),\n    }\n  },\n}\n"})}),"\n",(0,s.jsx)(t.p,{children:"Then include the analytics utility functions in your screen or store slice and call the event name:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"import { getAnalyticsTimers, logAnalyticsEvent, setAnalyticsUserProperty } from 'utils/analytics'\n\nexport const analyticsAction = (): AppThunk => async (dispatch, getState) => {\n  await setAnalyticsUserProperty(UserAnalytics.vama_uses_property(true))\n  const [totalTime] = getAnalyticsTimers(getState())\n  await logAnalyticsEvent(Events.vama_new_event_name(totalTime))\n  ...\n}\n"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"https://firebase.google.com/docs/analytics/",children:"Analytics"})," is added to the app through the ",(0,s.jsx)(t.code,{children:"@react-native-firebase/analytics"})," package."]}),"\n",(0,s.jsx)(t.h3,{id:"dashboard",children:"Dashboard"}),"\n",(0,s.jsxs)(t.p,{children:["The analytics dashboard provides a few common metrics that are important to the app, like current user engagement, active release versions, and user geolocation. You can drill down into the information on the dashboard by clicking on the ",(0,s.jsx)(t.code,{children:"All Users"})," button, which will pop open a sidebar which allows you to create a custom query to test the data against, with up to 5 conditions. The time range of the query is in the top-right of the main dashboard, outside of the pop-up. Once a new query is created and ",(0,s.jsx)(t.code,{children:"Apply"})," is pressed in the bottom right of the pop-up, the data shown will match all provided conditions only. Switching to the Realtime screen within Analytics will also apply these conditions. To clear a query, click on the ",(0,s.jsx)(t.code,{children:"X"})," next to its name in the top-left where the ",(0,s.jsx)(t.code,{children:"All Users"})," button used to be."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Analytics Query",src:n(60791).A+"",width:"1292",height:"1107"})}),"\n",(0,s.jsx)(t.h3,{id:"realtime",children:"Realtime"}),"\n",(0,s.jsx)(t.p,{children:"Selecting the Realtime dashboard will show all events that occured within the indicated time range and which match the active query in the comparisons list at the top of the screen. This screen shows the geolocations of all these events grouped to the nearest city. Underneath the map, a breakdown of the event types and rankings of each is also provided."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Analytics Realtime",src:n(55901).A+"",width:"1292",height:"1185"})}),"\n",(0,s.jsx)(t.h3,{id:"events",children:"Events"}),"\n",(0,s.jsx)(t.p,{children:"The Events page shows a list of all discrete events in the app, the count of each event firing, and the number of unique users who initiated that event. The events list can be filtered for a specific date range, but no other filters can be applied on this screen."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Analytics Events",src:n(30437).A+"",width:"1649",height:"1167"})}),"\n",(0,s.jsx)(t.h3,{id:"debugview",children:"DebugView"}),"\n",(0,s.jsxs)(t.p,{children:["DebugView allows developers to get a live stream of events in real-time, with up to a 60 second delay when first starting. A ",(0,s.jsx)(t.code,{children:"Firebase Debug Mode"})," toggle has been added to the developer screen to make debugging easier."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Analytics DebugView",src:n(94734).A+"",width:"1575",height:"1212"})}),"\n",(0,s.jsx)(t.p,{children:"For developers building locally, follow the steps listed below to get started:"}),"\n",(0,s.jsx)(t.p,{children:"iOS:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Make sure the ",(0,s.jsx)(t.code,{children:"-FIRDebugEnabled"})," flag is enabled in your XCode > Product > Scheme > Edit Scheme, under the Test (Debug) scheme"]}),"\n",(0,s.jsx)(t.li,{children:"Start the emulator or build to device"}),"\n",(0,s.jsxs)(t.li,{children:["In the app, go to Profile > Settings > Developer and toggle ",(0,s.jsx)(t.code,{children:"Firebase Debug Mode"})," on"]}),"\n",(0,s.jsx)(t.li,{children:"Go the Firebase Debug dashboard and select your device from the top left Debug Devices list"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Android:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Open Android Studio and run the emulator or build to device"}),"\n",(0,s.jsxs)(t.li,{children:["In a terminal, execute the command ",(0,s.jsx)(t.code,{children:"adb shell setprop debug.firebase.analytics.app gov.va.mobileapp"})]}),"\n",(0,s.jsxs)(t.li,{children:["In the app, go to Profile > Settings > Developer and toggle ",(0,s.jsx)(t.code,{children:"Firebase Debug Mode"})," on"]}),"\n",(0,s.jsx)(t.li,{children:"Go the Firebase Debug dashboard and select your device from the top left Debug Devices list"}),"\n",(0,s.jsxs)(t.li,{children:["After debugging is complete, run the command ",(0,s.jsx)(t.code,{children:"adb shell setprop debug.firebase.analytics.app .none."})]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"For QA team members, DebugView does not work using a signed build. Either build locally using the steps above, or use the steps below, but be aware that the wait time is high and it doesn't always work due to the way events are batched and sent to the Dashboard:"}),"\n",(0,s.jsx)(t.p,{children:"On either platform:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["In the app, go to Profile > Settings > Developer and click ",(0,s.jsx)(t.code,{children:"Enable Firebase Debug Mode"})]}),"\n",(0,s.jsx)(t.li,{children:"Go to the Firebase Realtime dashboard"}),"\n",(0,s.jsxs)(t.li,{children:["Click on the ",(0,s.jsx)(t.code,{children:"All Users"})," button at the top left. A ",(0,s.jsx)(t.code,{children:"Build Comparison"})," menu will pop up."]}),"\n",(0,s.jsxs)(t.li,{children:["Set ",(0,s.jsx)(t.code,{children:"Audience Name"})," to ",(0,s.jsx)(t.code,{children:"Environment"})," and the ",(0,s.jsx)(t.code,{children:"Dimension Values"})," to ",(0,s.jsx)(t.code,{children:"Staging"})," if available. If not available, no staging events have been logged in the time period"]}),"\n",(0,s.jsxs)(t.li,{children:["Click ",(0,s.jsx)(t.code,{children:"Apply"})," and any events in that time period that have been logged will be shown on the map and in the lists"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},90541:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/firebase-app-distro-c6edbde8a801441880f6dc9f89eb2c0d.png"},94734:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/firebase-debugview-9c8fb368cdf5966da47cf23ca407c87f.png"}}]);