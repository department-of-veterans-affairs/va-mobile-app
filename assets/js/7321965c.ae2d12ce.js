"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[4603],{77993:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var n=a(58168),r=(a(96540),a(15680));a(41873);const o={sidebar_position:5,sidebar_label:"Other Workflows"},i="Other Workflows",l={unversionedId:"Engineering/DevOps/Automation Code Docs/GitHub Actions/OtherWorkflows",id:"Engineering/DevOps/Automation Code Docs/GitHub Actions/OtherWorkflows",title:"Other Workflows",description:"This is a list of all the reusable workflows in GitHub Actions and what they do.",source:"@site/docs/Engineering/DevOps/Automation Code Docs/GitHub Actions/OtherWorkflows.md",sourceDirName:"Engineering/DevOps/Automation Code Docs/GitHub Actions",slug:"/Engineering/DevOps/Automation Code Docs/GitHub Actions/OtherWorkflows",permalink:"/va-mobile-app/docs/Engineering/DevOps/Automation Code Docs/GitHub Actions/OtherWorkflows",draft:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5,sidebar_label:"Other Workflows"},sidebar:"tutorialSidebar",previous:{title:"Code Quality Workflows",permalink:"/va-mobile-app/docs/Engineering/DevOps/Automation Code Docs/GitHub Actions/CodeQualityWorkflows"},next:{title:"Release Issues",permalink:"/va-mobile-app/docs/Engineering/DevOps/Automation Code Docs/GitHub Actions/ReleaseIssues"}},s={},p=[{value:"Check for linked issues in PRs (<code>check-linked-issues</code>)",id:"check-for-linked-issues-in-prs-check-linked-issues",level:2},{value:"Description",id:"description",level:3},{value:"Trigger",id:"trigger",level:2},{value:"Add User to va-mobile-team repo (<code>add_new_user</code>)",id:"add-user-to-va-mobile-team-repo-add_new_user",level:2},{value:"Description",id:"description-1",level:3},{value:"Trigger",id:"trigger-1",level:3},{value:"Steps/Source",id:"stepssource",level:3},{value:"Slash Command Dispatch (<code>slash_commands</code>)",id:"slash-command-dispatch-slash_commands",level:2},{value:"Description",id:"description-2",level:3},{value:"Trigger",id:"trigger-2",level:3},{value:"Start Slack Thread (<code>start_slack_thread</code>)",id:"start-slack-thread-start_slack_thread",level:2},{value:"Description",id:"description-3",level:3},{value:"Trigger",id:"trigger-3",level:3},{value:"Parameters",id:"parameters",level:3},{value:"Outputs",id:"outputs",level:3},{value:"Steps/Source",id:"stepssource-1",level:4},{value:"Documentation Site Workflows",id:"documentation-site-workflows",level:2},{value:"Deploy Site (<code>documentation_deploy</code>)",id:"deploy-site-documentation_deploy",level:3},{value:"Description",id:"description-4",level:4},{value:"Trigger",id:"trigger-4",level:4},{value:"Steps/Source",id:"stepssource-2",level:3},{value:"Test Build (<code>documentation_test_build</code>)",id:"test-build-documentation_test_build",level:3},{value:"Description",id:"description-5",level:4},{value:"Trigger",id:"trigger-5",level:4},{value:"Steps/Source",id:"stepssource-3",level:4}],d={toc:p},u="wrapper";function c(e){let{components:t,...a}=e;return(0,r.yg)(u,(0,n.A)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"other-workflows"},"Other Workflows"),(0,r.yg)("p",null,"This is a list of all the reusable workflows in GitHub Actions and what they do."),(0,r.yg)("p",null,"In an effort to reduce the page size, large workflow code will be linked instead of being provided here."),(0,r.yg)("h2",{id:"check-for-linked-issues-in-prs-check-linked-issues"},"Check for linked issues in PRs (",(0,r.yg)("inlineCode",{parentName:"h2"},"check-linked-issues"),")"),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://github.com/department-of-veterans-affairs/va-mobile-app/actions/workflows/check-linked-issues.yml"},"View the check linked issues workflow file")),(0,r.yg)("h3",{id:"description"},"Description"),(0,r.yg)("p",null,"This workflow checks most pull requests to make sure there is an issue connected. This helps us build out release reports and manage tasks as they pass through the system. ",(0,r.yg)("a",{parentName:"p",href:"https://docs.github.com/en/issues/tracking-your-work-with-issues/using-issues/linking-a-pull-request-to-an-issue"},"Read more about how to connect a pull request to an issue"),"."),(0,r.yg)("h2",{id:"trigger"},"Trigger"),(0,r.yg)("p",null,"This workflow triggers inside a pull request, ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/department-of-veterans-affairs/va-mobile-app/actions/workflows/check-linked-issues.yml#L17"},"excluding a few branch names")),(0,r.yg)("h2",{id:"add-user-to-va-mobile-team-repo-add_new_user"},"Add User to va-mobile-team repo (",(0,r.yg)("inlineCode",{parentName:"h2"},"add_new_user"),")"),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://github.com/department-of-veterans-affairs/va-mobile-app/actions/workflows/add_new_user.yml"},"View on GitHub Actions")),(0,r.yg)("h3",{id:"description-1"},"Description"),(0,r.yg)("p",null,"Workflow used to add a new user to the ",(0,r.yg)("inlineCode",{parentName:"p"},"flagship-mobile-team")," in GitHub, which grants write and read access tot he ",(0,r.yg)("inlineCode",{parentName:"p"},"va-mobile-app")," repository and to our ZenHub instance. "),(0,r.yg)("h3",{id:"trigger-1"},"Trigger"),(0,r.yg)("p",null,"Creation of ",(0,r.yg)("inlineCode",{parentName:"p"},"Add User to VA Flagship Mobile Team")," ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/department-of-veterans-affairs/va-mobile-app/issues/new/choose"},"template")," in ",(0,r.yg)("inlineCode",{parentName:"p"},"va-mobile-app")," repository. "),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"on:\n  issues:\n    types: [labeled]\n")),(0,r.yg)("h3",{id:"stepssource"},"Steps/Source"),(0,r.yg)("p",null," Click for full source"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-javascript"},'...\nconst extractUsernameRegex = /@[a-zA-Z-_0-9]+/;\nconst username = getFirstMatch(extractUsernameRegex, context.payload.issue.body).substring(1);\n\n\nif(username) {\n  await inviteToTeam(username)\n  await addComment("User added successfully")\n  await addLabels("complete")\n  await closeIssue()\n} else {\n  // error\n  const errorMessage = "Invalid username. Requires manual addition to team"\n  // assign for manual approval and addition, add error label\n  await addAssignees(EXCEPTION_ASSIGNEES)\n  await addLabels("needs-approval")\n  await addComment(errorMessage)\n}\n...\n')),(0,r.yg)("hr",null),(0,r.yg)("h2",{id:"slash-command-dispatch-slash_commands"},"Slash Command Dispatch (",(0,r.yg)("inlineCode",{parentName:"h2"},"slash_commands"),")"),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://github.com/department-of-veterans-affairs/va-mobile-app/actions/workflows/slash_commands.yml"},"View on GitHub Actions")),(0,r.yg)("h3",{id:"description-2"},"Description"),(0,r.yg)("p",null,"Workflow sets up any slash commands that have been created to run in a newly created issue. "),(0,r.yg)("p",null,"Uses the ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/peter-evans/slash-command-dispatch"},"Slash Command Dispatch Action")," from GitHub Marketplace"),(0,r.yg)("p",null,'This can be used to add any more "chat ops"-type automations in the future by adding to the ',(0,r.yg)("inlineCode",{parentName:"p"},"commands:")," option"),(0,r.yg)("h3",{id:"trigger-2"},"Trigger"),(0,r.yg)("p",null,"Runs on every issue created comment and fires any slash commands installed if found."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"on:\n  issue_comment:\n    types: [created]\n")),(0,r.yg)("hr",null),(0,r.yg)("h2",{id:"start-slack-thread-start_slack_thread"},"Start Slack Thread (",(0,r.yg)("inlineCode",{parentName:"h2"},"start_slack_thread"),")"),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://github.com/department-of-veterans-affairs/va-mobile-app/actions/workflows/start_slack_thread.yml"},"View on GitHub Actions")),(0,r.yg)("h3",{id:"description-3"},"Description"),(0,r.yg)("p",null,"Reusable job that sends a message to a specified channel in DSVA slack and starts a thread to keep from cluttering the Slack feed."),(0,r.yg)("h3",{id:"trigger-3"},"Trigger"),(0,r.yg)("p",null,"Runs when called by another workflow"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"on:\n  workflow_call:\n")),(0,r.yg)("h3",{id:"parameters"},"Parameters"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Name"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"),(0,r.yg)("th",{parentName:"tr",align:null},"type"),(0,r.yg)("th",{parentName:"tr",align:null},"default?"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"channel_name"),(0,r.yg)("td",{parentName:"tr",align:null},"Name of the Slack channel where the thread should be started"),(0,r.yg)("td",{parentName:"tr",align:null}),(0,r.yg)("td",{parentName:"tr",align:null})),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"message"),(0,r.yg)("td",{parentName:"tr",align:null},"String value of the message that will serve as the top of the thread in Slack channel"),(0,r.yg)("td",{parentName:"tr",align:null},"string"),(0,r.yg)("td",{parentName:"tr",align:null},"none")))),(0,r.yg)("h3",{id:"outputs"},"Outputs"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Name"),(0,r.yg)("th",{parentName:"tr",align:null},"Description"),(0,r.yg)("th",{parentName:"tr",align:null},"type"),(0,r.yg)("th",{parentName:"tr",align:null},"default?"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"thread_ts"),(0,r.yg)("td",{parentName:"tr",align:null},"Timestamp of the Slack thread that was created. Gets passed to other steps for future use."),(0,r.yg)("td",{parentName:"tr",align:null}),(0,r.yg)("td",{parentName:"tr",align:null})))),(0,r.yg)("hr",null),(0,r.yg)("h4",{id:"stepssource-1"},"Steps/Source"),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://github.com/department-of-veterans-affairs/va-mobile-app/blob/develop/.github/workflows/update_testrail_run.yml"},"See in repository")),(0,r.yg)("hr",null),(0,r.yg)("h2",{id:"documentation-site-workflows"},"Documentation Site Workflows"),(0,r.yg)("h3",{id:"deploy-site-documentation_deploy"},"Deploy Site (",(0,r.yg)("inlineCode",{parentName:"h3"},"documentation_deploy"),")"),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://github.com/department-of-veterans-affairs/va-mobile-app/actions/workflows/documentation_deploy.yml"},"View on GitHub Actions")),(0,r.yg)("h4",{id:"description-4"},"Description"),(0,r.yg)("p",null,"Workflow that runs every day to update this documentation site with any approved changes."),(0,r.yg)("h4",{id:"trigger-4"},"Trigger"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},'on:\n  workflow_dispatch:\n  schedule:\n    - cron: "0 3 * * *" # Runs at 03:00 AM (UTC) every day (Check https://crontab.guru/)\n')),(0,r.yg)("p",null,"Runs every day at 0300 UTC"),(0,r.yg)("h3",{id:"stepssource-2"},"Steps/Source"),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://github.com/department-of-veterans-affairs/va-mobile-app/blob/develop/.github/workflows/documentation_deploy.yml"},"See in repository")),(0,r.yg)("hr",null),(0,r.yg)("h3",{id:"test-build-documentation_test_build"},"Test Build (",(0,r.yg)("inlineCode",{parentName:"h3"},"documentation_test_build"),")"),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://github.com/department-of-veterans-affairs/va-mobile-app/actions/workflows/documentation_test_build.yml"},"View on GitHub Actions")),(0,r.yg)("h4",{id:"description-5"},"Description"),(0,r.yg)("p",null,"Automated workflow that runs on every PR that touches autogenerated content for this documentation site to make sure that not of the changes breaks the automatic build and deploy of the site. "),(0,r.yg)("h4",{id:"trigger-5"},"Trigger"),(0,r.yg)("p",null,"Runs on every pull request to ",(0,r.yg)("inlineCode",{parentName:"p"},"develop")," branch that touches the following paths:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"VAMobile/src/components/**")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"VAMobile/documentation/**")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"VAMobile/src/utils/hooks.tsx"))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"on:\n  pull_request:\n    branches: [develop]\n    paths: \n      - VAMobile/src/components/**\n      - VAMobile/documentation/**\n      - VAMobile/src/utils/hooks.tsx\n")),(0,r.yg)("h4",{id:"stepssource-3"},"Steps/Source"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-yaml"},"test-deploy:\n  name: Test\n  runs-on: ubuntu-latest\n  steps:\n    - uses: actions/checkout@v3\n    - uses: actions/setup-node@v3\n      with:\n        node-version: 16.x\n        cache: yarn\n        cache-dependency-path: VAMobile/yarn.lock\n    - name: Test build\n      working-directory: VAMobile\n      run: |\n        yarn install --frozen-lockfile\n        cd documentation\n        yarn install --frozen-lockfile\n        yarn build\n")))}c.isMDXComponent=!0},15680:(e,t,a)=>{a.d(t,{xA:()=>d,yg:()=>m});var n=a(96540);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},d=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=p(a),g=r,m=u["".concat(s,".").concat(g)]||u[g]||c[g]||o;return a?n.createElement(m,i(i({ref:t},d),{},{components:a})):n.createElement(m,i({ref:t},d))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=g;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:r,i[1]=l;for(var p=2;p<o;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}g.displayName="MDXCreateElement"},41873:(e,t,a)=>{a(96540)}}]);