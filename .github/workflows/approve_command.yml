name: 'Approve Slash Command'

on:
  workflow_dispatch:
    inputs:
      notes:
        description: 'Notes'
        required: false

jobs:
  indicate_start:
    runs-on: ubuntu-latest
    steps:
      - name: 'Add reaction to approve command'
        uses: peter-evans/create-or-update-comment@v1
        with:
          token: ${{ secrets.GH_ACTIONS_PAT }}
          repository: ${{ github.event.client_payload.github.payload.repository.full_name }}
          comment-id: '1003145956' #${{ github.event.client_payload.github.payload.comment.id }}
          reaction-type: rocket
  run_prs:
    uses: department-of-veterans-affairs/va-mobile-app/.github/workflows/test.yml@slash-command
  comment_complete:
    runs-on: ubuntu-latest
    needs: run_prs
    steps:
      - name: 'Checkout repo'
        uses: actions/checkout@v2
      - name: 'Set up GH CLI secret'
        run: echo "${{ secrets.GITHUB_TOKEN }}" >> token.txt
      - name: 'Log into GH CLI'
        run: gh auth login --with-token < token.txt
      - name: 'test reuse envs come through'
        run: |
          gh issue comment 2255 -b "PRs Successfully Created! :raised-hands:
          [PR to develop](${{needs.run_prs.outputs.devPrUrl}})
          PR to master](${{needs.run_prs.outputs.releasePrUrl}})"
