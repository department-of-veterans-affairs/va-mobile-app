#
# Checks if health/global/design-system label is applied and then assigns the correct QA team member to that ticket
#

name: '[Utils] Assign QA to issue'

on:
  pull_request:
    types:
      - labeled
env:
  GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}

jobs:
  assign_qa:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    steps:
      - name: 'Checkout repo'
        uses: actions/checkout@v3

      - name: Assign Health team QA
        if: contains(github.event.pull_request.labels.*.name, fromJson('["Health", "FE-With QA"]'))
        run: |
          gh pr edit ${{ github.event.pull_request.number }} --add-assignee "rbontrager"
      - name: Assign Global team QA
        if: |
          contains(github.event.pull_request.labels.*.name, 'global') && 
          contains(github.event.pull_request.labels.*.name, 'FE-With QA')
        run: |
          gh pr edit ${{ github.event.pull_request.number }} --add-assignee "TKDickson"

      - name: Assign Design-System team QA
        if: |
          contains(github.event.pull_request.labels.*.name, 'design-system') && 
          contains(github.event.pull_request.labels.*.name, 'FE-With QA')  
        run: |
          gh pr edit ${{ github.event.pull_request.number }} --add-assignee "DJUltraTom"
      
      - name: Assign all other issues to adam
        if: github.event.label.name == 'FE-With QA' && (github.event.label.name != 'Health' || github.event.label.name != 'global' || github.event.label.name != 'design-system')
        run: |
          gh issue edit ${{ github.event.pull_request.number }} --add-assignee "bischoffa"
      
