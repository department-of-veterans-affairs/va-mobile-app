name: Test get issues by label
on:
  push:
    branches:
      - feature/add-bugs-to-release-ticket

jobs:
  getIssues:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: echo "${{ secrets.GITHUB_TOKEN }}" >> token.txt
      - run: gh auth login --with-token < token.txt
#      - run: gh issue list -l "sev-2" --jq 'map("|\(.number)|\(.title)|") | join("\n") ' --json number,title
#      - run: issues=$(gh issue list -l "sev-2" --jq 'map("|\(.number)|\(.title)|") | join("\n") ' --json number,title)
#      - run: echo $issues
      - run: |
          issues=$(gh issue list -l "sev-2" --jq 'map("|\(.number)|\(.title)|") | join("\n") ' --json number,title)
          echo ${issues}
          table="| Issue | Title | Notes |\n"
          table="${table}|-------|-------|-------|\n"
          echo "${table}${issues}"
      - name: Archive results
        uses: actions/upload-artifact@v2
        with:
          name: issues output
          path: outputs.txt
