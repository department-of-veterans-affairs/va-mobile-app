name: Test get issues by label
on:
  push:
    branches:
      - feature/add-bugs-to-release-ticket

jobs:
  getIssues:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: echo "${{ secrets.GITHUB_TOKEN }}" >> token.txt
      - run: gh auth login --with-token < token.txt
      - run: issues=$(gh issue list -l "sev-2" --json number,title)
      - run: echo "${issues}"
      - run: |
          table="| Issue | Title | Notes |\n"
          table="${table}|-------|-------|-------|\n"
          for i in "${issues[@]}"
          do
            echo "${i}"
            table="${table}|#${i[number]}|${i[title]}| |\n"
          done
          echo "${table}"
      - name: Archive results
        uses: actions/upload-artifact@v2
        with:
          name: issues output
          path: outputs.txt
