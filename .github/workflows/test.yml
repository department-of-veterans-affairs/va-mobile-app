name: Test get issues by label
on:
  push:
    branches:
      - feature/add-bugs-to-release-ticket

jobs:
  getIssues:
    runs-on: ubuntu-latest
    steps:
      - uses: octokit/request-action@v2.x
        id: get_issues
        with:
          route: GET /repos/{owner}/{repo}/issues?labels=sev-2
          owner: department-of-veterans-affairs
          repo: va-mobile-app
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      - run: |
          table='| Issue | Title | Notes |\n'
          table='${table}|-------|-------|-------|\n'
          for i in "${steps.get_issues.output.data[@]}"
          do
            table='${table}|#${id[number]}|${id[title]}| |\n'
          done
          echo table
      - name: Archive results
        uses: actions/upload-artifact@v2
        with:
          name: issues output
          path: outputs.txt
